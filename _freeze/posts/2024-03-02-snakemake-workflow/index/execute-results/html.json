{
  "hash": "d53b57366640b4aacc49ee042722047f",
  "result": {
    "markdown": "---\ntitle: ä½¿ç”¨Githubçš„Snakemakeæµç¨‹\nauthor: metseq\ndate: '2024-03-02'\ncategories:\n  - Bioinformatics\ntoc: true\nnumber-sections: false\nexecute:\n  eval: false\n  echo: true\n  warning: false\n  message: false\n---\n\n# æ¦‚è¿°\nGitHubæœ‰ä¸€ä¸ª[snakemakeæµç¨‹çš„åˆ†ç±»](https://snakemake.github.io/snakemake-workflow-catalog/)ï¼Œé‡Œé¢æœ‰å¾ˆå¤šç”Ÿä¿¡åˆ†ææµç¨‹ï¼Œrna-seq-star-deseq2ï¼Œdna-seq-gatk-variant-callingã€‚\n\næˆ‘æµ‹è¯•äº†[rna-seq-star-deseq2](https://github.com/snakemake-workflows/rna-seq-star-deseq2)è¿™ä¸ªæµç¨‹ã€‚\n\næ¯ä¸ªæµç¨‹éƒ½æœ‰ä½¿ç”¨è¯´æ˜ï¼Œå¦‚æœéƒ½çœ‹è¯´æ˜å¯ä»¥è·‘é€šï¼Œé‚£å°±å¥½äº†ğŸ¥¹\n\nä¸‹é¢å‚è€ƒ[rna-seq-star-deseq2çš„è¯´æ˜](https://snakemake.github.io/snakemake-workflow-catalog/?usage=snakemake-workflows%2Frna-seq-star-deseq2)ï¼Œä¸€æ­¥ä¸€æ­¥åš.\n\n\n# Step 1 å®‰è£…snamakeå’Œsnakedeploy\n\n\n```{bash}\n# ä½¿ç”¨mambaå®‰è£…snakemeå’Œsnakedeployï¼Œå¦‚æœæ²¡æœ‰mambaï¼Œè‡ªè¡Œæœç´¢å®‰è£…å§\nmamba create -c conda-forge -c bioconda --name snakemake snakemake snakedeploy\n\nconda activate snakemake\n```\n\n\n# Step 2 æµç¨‹éƒ¨ç½²\n\n\n```{bash}\nmkdir proj_240302_test_snakemake\n\ncd proj_240302_test_snakemake\n\nsnakedeploy deploy-workflow https://github.com/snakemake-workflows/rna-seq-star-deseq2 . --tag v2.1.0\n```\n\n\nè¿è¡Œæ—¶å€™çš„æ–‡ä»¶ç»“æ„ï¼š\n\n\n```{bash}\n$ tree\n.\nâ”œâ”€â”€ config\nâ”‚Â Â  â”œâ”€â”€ README.md\nâ”‚Â Â  â”œâ”€â”€ config.yaml\nâ”‚Â Â  â”œâ”€â”€ samples.tsv\nâ”‚Â Â  â””â”€â”€ units.tsv\nâ””â”€â”€ workflow\n    â””â”€â”€ Snakefile\n```\n\n\nå…¶å®å°±ä¸‹äº†configå’Œworkflowä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œé‡Œé¢åˆ†åˆ«æ˜¯é…ç½®æ–‡ä»¶å’Œæµç¨‹ã€‚workflowé‡Œé¢åªæœ‰ä¸€ä¸ªSnakefileï¼ŒSnakefileé‡ŒæŠŠgithubä¸Š\nrna-seq-star-deseq2çš„æµç¨‹ä½œä¸ºæ¨¡å—å¯¼å…¥äº†ã€‚\n\n# Step 3 é…ç½®æµç¨‹\n\næµç¨‹é…ç½®æ˜¯æœ€éº»çƒ¦çš„ï¼Œæˆ‘ä¸‹è½½äº†[ä»“åº“](https://github.com/snakemake-workflows/rna-seq-star-deseq2.git)è‡ªå¸¦çš„æµ‹è¯•æ•°æ®ã€‚\n\næµ‹è¯•æ•°æ®åœ¨`.test`æ–‡ä»¶å¤¹ä¸‹é¢ï¼Œç»“æ„å¦‚ä¸‹ï¼Œåº”è¯¥å¾ˆæ¸…æ¥šäº†ï¼Œ`config_basic`å°±æ˜¯ç®€å•ç‰ˆçš„é…ç½®æ–‡ä»¶ï¼Œ`config_complex`æ–‡ä»¶å¤¹æ˜¯å¤æ‚ç‰ˆçš„é…ç½®æ–‡ä»¶ï¼Œ`ngs-test-data`å°±æ˜¯åŸå§‹æ•°æ®äº†ã€‚\n\n\n```{bash}\n$ tree .test\n.\nâ”œâ”€â”€ config_basic\nâ”‚Â Â  â”œâ”€â”€ config.yaml\nâ”‚Â Â  â”œâ”€â”€ samples.tsv\nâ”‚Â Â  â””â”€â”€ units.tsv\nâ”œâ”€â”€ config_complex\nâ”‚Â Â  â”œâ”€â”€ config.yaml\nâ”‚Â Â  â”œâ”€â”€ samples.tsv\nâ”‚Â Â  â””â”€â”€ units.tsv\nâ””â”€â”€ ngs-test-data\n    â””â”€â”€ reads\n        â”œâ”€â”€ a.chr21.1.fq\n        â”œâ”€â”€ a.chr21.2.fq\n        â”œâ”€â”€ a.scerevisiae.1.fq\n        â”œâ”€â”€ a.scerevisiae.2.fq\n        â”œâ”€â”€ b.chr21.1.fq\n        â”œâ”€â”€ b.chr21.2.fq\n        â”œâ”€â”€ b.scerevisiae.1.fq\n        â”œâ”€â”€ b.scerevisiae.2.fq\n        â”œâ”€â”€ c.scerevisiae.1.fq\n        â””â”€â”€ c.scerevisiae.2.fq\n\n5 directories, 16 files\n```\n\n\nåˆ æ‰`Step 2 æµç¨‹éƒ¨ç½²`ä¸‹è½½çš„configæ–‡ä»¶ï¼ŒæŠŠ`.test/config_basic`ä¸­çš„é…ç½®æ–‡ä»¶éƒ½æ‹·è´`proj_240302_test_snakemake/config`æ–‡ä»¶å¤¹ä¸‹ï¼Œç„¶åæŠŠ`.test/ngs-test-data`æ–‡ä»¶å¤¹æ‹·è´åˆ°`proj_240302_test_snakemake`æ–‡ä»¶å¤¹ã€‚\n\nä¿®æ”¹`proj_240302_test_snakemake/config/config.yaml`æ–‡ä»¶çš„sampleså’Œunité…ç½®è·¯å¾„ï¼š\n\n\n```{bash}\nsamples: config/samples.tsv\nunits: config/units.tsv\n```\n\n\né…ç½®æœ‰å¾ˆå¤šç»†èŠ‚ï¼Œæ¯”å¦‚åŸå§‹æ•°æ®çš„æ¥å¤´åºåˆ—ï¼Œå·®å¼‚è¡¨è¾¾åˆ†ç»„ä¿¡æ¯ï¼Œæ˜¯å¦æ˜¯é“¾ç‰¹å¼‚æ–‡åº“ç­‰ç­‰ã€‚\n\nè¯·å‚è€ƒé…ç½®æ–‡ä»¶çš„è¯´æ˜å’Œæµç¨‹è‡ªå¸¦çš„é…ç½®è¯´æ˜ã€‚å½“ç„¶`.test`æ–‡ä»¶å¤¹ä¸­çš„é…ç½®æ–‡ä»¶æ ¼å¼å€¼å¾—å‚è€ƒã€‚\n\n# Step 4 è¿è¡Œæµç¨‹\n\nç»ˆäºå¯ä»¥è¿è¡Œæµç¨‹äº†ï¼š\n\n\n```{bash}\nsnakemake --cores all --use-conda\n```\n\n\næœç„¶æŠ¥é”™äº†ğŸ˜­ï¼š\n\n```\nNotImplementedError: Remote providers have been replaced by Snakemake storage plugins. Please use the corresponding storage plugin instead (snakemake-storage-plugin-*).\n```\n\nGoogleä¸€ä¸‹ï¼Œrna-seq-star-deseq2é‡Œæœ‰ä¸€ä¸ª[issues](https://github.com/snakemake-workflows/rna-seq-star-deseq2/issues/71)å°±æ˜¯è¿™ä¸ªé—®é¢˜ã€‚\n\nåŸå› æ˜¯snakemakeæµç¨‹æœ€è¿‘ï¼ˆ2024å¹´3æœˆ3æ—¥ï¼‰æ—¥æ›´æ–°åˆ°ç‰ˆæœ¬8äº†ï¼Œç‰ˆæœ¬8å¼•å…¥äº†pluginåŠŸèƒ½ï¼Œrna-seq-star-deseq2æµç¨‹è¿˜ä¸æ”¯æŒã€‚issuesé‡Œä¹Ÿç»™å‡ºäº†è§£å†³åŠæ³•ï¼Œåˆ é™¤å·²ç»è£…å¥½çš„snakemakeçš„condaç¯å¢ƒï¼Œç„¶åå®‰è£…7.32.4ç‰ˆæœ¬çš„snakemakeã€‚\n\n\n```{bash}\nmamba deactivate\n\nmamba remove -n snakemake --all\n\nmamba create -c conda-forge -c bioconda -n snakemake7 snakemake=7.32.4 \n\nmamba activate snakemake7\n```\n\n\né‡æ–°é…ç½®å¥½ç¯å¢ƒåï¼Œå†æ¬¡è¿è¡Œæµç¨‹ï¼š\n\n\n```{bash}\nsnakemake --cores all --use-conda\n```\n\n\næµç¨‹ä¼šå…ˆä¸‹è½½ä¾èµ–çš„ç¯å¢ƒï¼Œå‚è€ƒåŸºå› ç»„ï¼ˆæˆ‘ç”¨äº†å¤§çº¦20åˆ†é’Ÿï¼‰ï¼Œç„¶åè¿è¡Œé‡Œé¢å®šä¹‰çš„æ­¥éª¤ã€‚\n\nç»“æœæ–‡ä»¶åœ¨`results`æ–‡ä»¶å¤¹ä¸‹ï¼š\n\n\n```{bash}\n$ ll -rth results/\ntotal 120\ndrwxr-xr-x  14 chenmin  staff   448B Mar  3 00:17 trimmed\ndrwxr-xr-x   6 chenmin  staff   192B Mar  3 00:20 star\ndrwxr-xr-x   4 chenmin  staff   128B Mar  3 00:21 qc\ndrwxr-xr-x   4 chenmin  staff   128B Mar  3 00:22 counts\n-rw-r--r--@  1 chenmin  staff    59K Mar  3 00:22 pca.condition.svg\ndrwxr-xr-x   5 chenmin  staff   160B Mar  3 00:22 deseq2\ndrwxr-xr-x   5 chenmin  staff   160B Mar  3 00:23 diffexp\n```\n\n\n# Step 5 ç”ŸæˆæŠ¥å‘Š\n\n\n```{bash}\nsnakemake --report report.zip\n```\n\n\nè§£å‹report.zipï¼Œæ‰“å¼€report.htmlï¼Œç½‘é¡µå·¦ä¾§æœ‰4ä¸ªé€‰é¡¹ï¼ŒWorkflowæ˜¯æµç¨‹è¿è¡Œçš„æ­¥éª¤ï¼Œè¯´æ˜ï¼›Statisticsç»Ÿè®¡äº†æ¯ä¸€æ­¥è¿è¡Œçš„æ—¶é—´ï¼›Aboutæ˜¯æµç¨‹ç”¨åˆ°è½¯ä»¶çš„ä½¿ç”¨æƒé™è¯´æ˜ï¼›Resultsæ˜¯æœ€å…³å¿ƒçš„ç»“æœäº†ã€‚\n\næµ‹è¯•å®ŒæˆğŸ‰\n\n",
    "supporting": [
      "index_files/figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}